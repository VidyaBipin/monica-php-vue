parameters:
  no_dev: 'false'
steps:
- task: CacheBeta@0
  inputs:
    key: composer-v1 | $(Agent.OS) | composer.lock
    path: $(COMPOSER_HOME)
  displayName: Cache composer packages
- bash: |
    sudo composer self-update
    composer global require hirak/prestissimo
    export EXTRA_PARAM=$(test "${{ parameters.no_dev }}" == "true" && echo "--no-dev")
    composer install --no-interaction --no-suggest --no-progress --ignore-platform-reqs ${EXTRA_PARAM:-}
  displayName: 'composer install'
